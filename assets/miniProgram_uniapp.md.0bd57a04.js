import{_ as s,c as a,o as n,Q as l}from"./chunks/framework.f14b72c3.js";const C=JSON.parse('{"title":"uniapp","description":"","frontmatter":{},"headers":[],"relativePath":"miniProgram/uniapp.md","lastUpdated":1681829744000}'),p={name:"miniProgram/uniapp.md"},o=l(`<h1 id="uniapp" tabindex="-1">uniapp <a class="header-anchor" href="#uniapp" aria-label="Permalink to &quot;uniapp&quot;">​</a></h1><h2 id="横屏配置" tabindex="-1">横屏配置 <a class="header-anchor" href="#横屏配置" aria-label="Permalink to &quot;横屏配置&quot;">​</a></h2><p>在<code>pages.json</code>中配置 <a href="https://uniapp.dcloud.io/collocation/pages.html#globalstyle" target="_blank" rel="noreferrer">pageOrientation: &quot;auto&quot;</a></p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki dracula"><code><span class="line"><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">globalStyle</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">: {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#8BE9FE;">&quot;</span><span style="color:#8BE9FD;">pageOrientation</span><span style="color:#8BE9FE;">&quot;</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">auto</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><p>此时已经可以全局切换横竖屏了，再分别给横竖屏各写一套样式</p><p>方式一、css 控制</p><div class="language-css"><button title="Copy Code" class="copy"></button><span class="lang">css</span><pre class="shiki dracula"><code><span class="line"><span style="color:#6272A4;">/* &lt;view class=&quot;landscape&quot;&gt;666&lt;/view&gt; */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">/* 竖屏 */</span></span>
<span class="line"><span style="color:#FF79C6;">@media</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">screen</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">and</span><span style="color:#F8F8F2;"> (</span><span style="color:#8BE9FD;">orientation</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">portrait</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#50FA7B;font-style:italic;">.landscape</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">color</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">#f00</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">/* 横屏 */</span></span>
<span class="line"><span style="color:#FF79C6;">@media</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">screen</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">and</span><span style="color:#F8F8F2;"> (</span><span style="color:#8BE9FD;">orientation</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">landscape</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#50FA7B;font-style:italic;">.landscape</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">color</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">#00f</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><p>方式二、js 控制</p><p>在 data 里定义<code>isLandScape: false</code>表示是否横屏，默认为竖屏</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#6272A4;">// &lt;view :class=&quot;{&#39;landscape&#39;: isLandScape}&quot;&gt;666&lt;/view&gt;</span></span>
<span class="line"><span style="color:#6272A4;">// .landscape { color: #00f; }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B;">onResize</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">  uni.</span><span style="color:#50FA7B;">getSystemInfo</span><span style="color:#F8F8F2;">({</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#50FA7B;">success</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> (</span><span style="color:#FFB86C;font-style:italic;">res</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> (res.windowWidth </span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;"> res.windowHeight) {</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">// 横屏</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.isLandScape </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">true</span></span>
<span class="line"><span style="color:#F8F8F2;">      } </span><span style="color:#FF79C6;">else</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#6272A4;">// 竖屏</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.isLandScape </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">false</span></span>
<span class="line"><span style="color:#F8F8F2;">      }</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">  })</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><p>还有一种是使用<code>uni.onWindowResize()</code>，但是在<code>onLoad()</code>和<code>onShow()</code>中，在切换时都会触发两次</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#50FA7B;">onLoad</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">  uni.</span><span style="color:#50FA7B;">onWindowResize</span><span style="color:#F8F8F2;">((</span><span style="color:#FFB86C;font-style:italic;">res</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> (res.size.windowWidth </span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;"> res.size.windowHeight) {</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.isLandScape </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">true</span></span>
<span class="line"><span style="color:#F8F8F2;">    } </span><span style="color:#FF79C6;">else</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.isLandScape </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">false</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">  })</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="app-离线打包" tabindex="-1">App 离线打包 <a class="header-anchor" href="#app-离线打包" aria-label="Permalink to &quot;App 离线打包&quot;">​</a></h2><p>官方文档：<a href="https://nativesupport.dcloud.net.cn/AppDocs/usesdk/android" target="_blank" rel="noreferrer">https://nativesupport.dcloud.net.cn/AppDocs/usesdk/android</a></p><h3 id="生成离线资源" tabindex="-1">生成离线资源 <a class="header-anchor" href="#生成离线资源" aria-label="Permalink to &quot;生成离线资源&quot;">​</a></h3><p>打开 HBuilderX 选择 发行 =&gt; 原生 App-本地打包 =&gt; 生成本地打包 App 资源，打包后的资源在<code>unpackage/resources</code>路径下</p><h3 id="开发环境" tabindex="-1">开发环境 <a class="header-anchor" href="#开发环境" aria-label="Permalink to &quot;开发环境&quot;">​</a></h3><ul><li>下载 Android Studio</li><li>下载 App 离线 SDK：<a href="https://nativesupport.dcloud.net.cn/AppDocs/download/android" target="_blank" rel="noreferrer">https://nativesupport.dcloud.net.cn/AppDocs/download/android</a></li><li>申请 Appkey：<a href="https://nativesupport.dcloud.net.cn/AppDocs/usesdk/appkey" target="_blank" rel="noreferrer">https://nativesupport.dcloud.net.cn/AppDocs/usesdk/appkey</a></li></ul><h3 id="android-studio-配置" tabindex="-1">android studio 配置 <a class="header-anchor" href="#android-studio-配置" aria-label="Permalink to &quot;android studio 配置&quot;">​</a></h3><h4 id="放置打包资源" tabindex="-1">放置打包资源 <a class="header-anchor" href="#放置打包资源" aria-label="Permalink to &quot;放置打包资源&quot;">​</a></h4><p>打开项目后找到 <code>assets/apps</code>目录，下一级目录名称是<code>__UNI__2A4F113</code>，这个是 uniapp 应用标识，可以在 HBuilderX 的 manifes.json 中找到，也可以在打包资源的 manifes.json 里找到。 该目录下面还有一个 www 目录，这里面就是放本地打包资源的。使用时将 www 目录下的文件全部删除，将自己的打包资源放进去。</p><p>在<code>assets/data/dcloud_control.xml</code>里也要修改应用标识</p><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">hbuilder</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">apps</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">app</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">appid</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">__UNI__2A4F113</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">appver</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;&quot;</span><span style="color:#F8F8F2;">/&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;/</span><span style="color:#FF79C6;">apps</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;/</span><span style="color:#FF79C6;">hbuilder</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h4 id="设置应用名称" tabindex="-1">设置应用名称 <a class="header-anchor" href="#设置应用名称" aria-label="Permalink to &quot;设置应用名称&quot;">​</a></h4><p>路径<code>app/src/main/res/values/strings.xml</code></p><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">resources</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">string</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">name</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">app_name</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">&gt;应用名称&lt;/</span><span style="color:#FF79C6;">string</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;/</span><span style="color:#FF79C6;">resources</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span></code></pre></div><h4 id="设置应用图标" tabindex="-1">设置应用图标 <a class="header-anchor" href="#设置应用图标" aria-label="Permalink to &quot;设置应用图标&quot;">​</a></h4><p>路径<code>app/src/main/res/</code>，新建一个文件夹<code>drawable-hdpi</code>，里面放 logo 图片</p><h3 id="配置-build-gradle" tabindex="-1">配置 build.gradle <a class="header-anchor" href="#配置-build-gradle" aria-label="Permalink to &quot;配置 build.gradle&quot;">​</a></h3><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">apply </span><span style="color:#F1FA8C;">plugin:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">com.android.application</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">android </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">    compileSdkVersion </span><span style="color:#BD93F9;">29</span></span>
<span class="line"><span style="color:#F8F8F2;">    buildToolsVersion </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">28.0.3</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    defaultConfig </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">        applicationId </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">uni.UNI2A4F113</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        minSdkVersion </span><span style="color:#BD93F9;">21</span></span>
<span class="line"><span style="color:#F8F8F2;">        targetSdkVersion </span><span style="color:#BD93F9;">28</span></span>
<span class="line"><span style="color:#F8F8F2;">        versionCode </span><span style="color:#BD93F9;">101</span></span>
<span class="line"><span style="color:#F8F8F2;">        versionName </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">1.7.85</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        multiDexEnabled </span><span style="color:#BD93F9;">true</span></span>
<span class="line"><span style="color:#F8F8F2;">        ndk </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">            abiFilters </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">armeabi-v7a</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">,</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">arm64-v8a</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">        }</span></span>
<span class="line"><span style="color:#F8F8F2;">        manifestPlaceholders </span><span style="color:#F1FA8C;">=</span><span style="color:#F8F8F2;"> [</span></span>
<span class="line"><span style="color:#E9F284;">                &quot;</span><span style="color:#F1FA8C;">apk.applicationId</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">     :</span><span style="color:#E9F284;"> &quot;</span><span style="color:#F1FA8C;">uni.UNI2A4F113</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#E9F284;">                &quot;</span><span style="color:#F1FA8C;">GETUI_APPID</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">           :</span><span style="color:#E9F284;"> &quot;</span><span style="color:#F1FA8C;">unipush的appid</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#E9F284;">                &quot;</span><span style="color:#F1FA8C;">plus.unipush.appid</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">    :</span><span style="color:#E9F284;"> &quot;</span><span style="color:#F1FA8C;">unipush的appid</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#E9F284;">                &quot;</span><span style="color:#F1FA8C;">plus.unipush.appkey</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">   :</span><span style="color:#E9F284;"> &quot;</span><span style="color:#F1FA8C;">unipuish的appkey</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#E9F284;">                &quot;</span><span style="color:#F1FA8C;">plus.unipush.appsecret</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">:</span><span style="color:#E9F284;"> &quot;</span><span style="color:#F1FA8C;">unipush的secrety</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">        ]</span></span>
<span class="line"><span style="color:#F8F8F2;">        compileOptions </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">            sourceCompatibility </span><span style="color:#F1FA8C;">JavaVersion.VERSION_1_8</span></span>
<span class="line"><span style="color:#F8F8F2;">            targetCompatibility </span><span style="color:#F1FA8C;">JavaVersion.VERSION_1_8</span></span>
<span class="line"><span style="color:#F8F8F2;">        }</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">    signingConfigs </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">        config </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">            keyAlias </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">__uni__2a4f113</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">            keyPassword </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">J02ojI7r</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">            storeFile </span><span style="color:#F1FA8C;">file</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">key.keystore</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">            storePassword </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">J02ojI7r</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">            v1SigningEnabled </span><span style="color:#BD93F9;">true</span></span>
<span class="line"><span style="color:#F8F8F2;">            v2SigningEnabled </span><span style="color:#BD93F9;">true</span></span>
<span class="line"><span style="color:#F8F8F2;">        }</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">    buildTypes </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">        debug </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">            signingConfig </span><span style="color:#F1FA8C;">signingConfigs.config</span></span>
<span class="line"><span style="color:#F8F8F2;">            minifyEnabled </span><span style="color:#BD93F9;">false</span></span>
<span class="line"><span style="color:#F8F8F2;">            proguardFiles </span><span style="color:#F1FA8C;">getDefaultProguardFile</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">proguard-android.txt</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F1FA8C;">,</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">proguard-rules.pro</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">        }</span></span>
<span class="line"><span style="color:#F8F8F2;">        release </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">            signingConfig </span><span style="color:#F1FA8C;">signingConfigs.config</span></span>
<span class="line"><span style="color:#F8F8F2;">            minifyEnabled </span><span style="color:#BD93F9;">false</span></span>
<span class="line"><span style="color:#F8F8F2;">            proguardFiles </span><span style="color:#F1FA8C;">getDefaultProguardFile</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">proguard-android.txt</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F1FA8C;">,</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">proguard-rules.pro</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">        }</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">    lintOptions </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">        checkReleaseBuilds </span><span style="color:#BD93F9;">false</span></span>
<span class="line"><span style="color:#F8F8F2;">        abortOnError </span><span style="color:#BD93F9;">false</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">    aaptOptions </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">        additionalParameters </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">--auto-add-overlay</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">        ignoreAssetsPattern </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">!.svn:!.git:.*:!CVS:!thumbs.db:!picasa.ini:!*.scc:*~</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"><span style="color:#F8F8F2;">repositories </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">    flatDir </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#8BE9FD;">dirs</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">libs</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"><span style="color:#F8F8F2;">dependencies </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">    implementation </span><span style="color:#F1FA8C;">fileTree</span><span style="color:#F8F8F2;">(include: [</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">*.jar</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">], </span><span style="color:#F1FA8C;">dir:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">libs</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    implementation </span><span style="color:#F1FA8C;">fileTree</span><span style="color:#F8F8F2;">(include: [</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">*.aar</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">], </span><span style="color:#F1FA8C;">dir:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">libs</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    implementation </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">androidx.appcompat:appcompat:1.0.0</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    implementation </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">androidx.legacy:legacy-support-v4:1.0.0</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    implementation </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">androidx.recyclerview:recyclerview:1.0.0</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    implementation </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">com.facebook.fresco:fresco:2.5.0</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    implementation </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">com.facebook.fresco:animated-gif:2.5.0</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">    implementation </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">com.github.bumptech.glide:glide:4.9.0</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    implementation </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">com.alibaba:fastjson:1.1.46.android</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><ol><li><p>配置应用标识<code>applicationId</code>，这里还是同上的应用标识</p></li><li><p>配置应用版本名称和版本号，这里要和 HBuilderX 的 manifes.json 中的版本号一致</p></li><li><p>配置 cpu 类型 ndk， <code>abiFilters &#39;armeabi-v7a&#39;, &#39;arm64-v8a&#39;</code>，去掉 x86， <a href="https://uniapp.dcloud.net.cn/tutorial/app-android-abifilters.html" target="_blank" rel="noreferrer">参考文档</a></p></li><li><p>配置签名证书</p></li></ol><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">    signingConfigs </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">        config </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">            keyAlias </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">__uni__2a4f113</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">            keyPassword </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">你的密码</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">            storeFile </span><span style="color:#F1FA8C;">file</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">key.keystore</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">            storePassword </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">你的密码</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">            v1SigningEnabled </span><span style="color:#BD93F9;">true</span></span>
<span class="line"><span style="color:#F8F8F2;">            v2SigningEnabled </span><span style="color:#BD93F9;">true</span></span>
<span class="line"><span style="color:#F8F8F2;">        }</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"></span></code></pre></div><p>keyAlias 别名、keyPassword 密码</p><p><code>storeFile file(&#39;key.keystore&#39;)</code>表示证书地址，在创建证书时会有一个 keystore 后缀的文件或者 jks 后缀的文件，将它放在和 build.gra 同级的目录</p><h3 id="配置-androidmanifest-xml" tabindex="-1">配置 AndroidManifest.xml <a class="header-anchor" href="#配置-androidmanifest-xml" aria-label="Permalink to &quot;配置 AndroidManifest.xml&quot;">​</a></h3><ol><li>在文件开头配置 package 名称，改为应用标识</li></ol><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">manifest</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">xmlns</span><span style="color:#FF79C6;font-style:italic;">:</span><span style="color:#50FA7B;font-style:italic;">android</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">http://schemas.android.com/apk/res/android</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#50FA7B;font-style:italic;">xmlns</span><span style="color:#FF79C6;font-style:italic;">:</span><span style="color:#50FA7B;font-style:italic;">tools</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">http://schemas.android.com/tools</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#50FA7B;font-style:italic;">package</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">uni.UNI2A4F113</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">&gt;&lt;/</span><span style="color:#FF79C6;">manifest</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>配置 android 权限</li></ol><p>类似<code>&lt;uses-permission android:name=&quot;android.permission.CAMERA&quot; /&gt;</code>这种权限配置，可以在 HBuilderX 的 manifes.json 中的 App 权限配置找到</p><ol start="3"><li>模块配置</li></ol><p><a href="https://nativesupport.dcloud.net.cn/AppDocs/usemodule/androidModuleConfig/geolocation" target="_blank" rel="noreferrer">文档地址</a></p><p>地图、消息推送等相关模块都可配置，按照文档引入工程需要的 jar/aar 文件，并在 application 节点下配置相关代码</p><ol start="4"><li>添加 provider 信息</li></ol><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">provider</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#50FA7B;font-style:italic;">android</span><span style="color:#FF79C6;font-style:italic;">:</span><span style="color:#50FA7B;font-style:italic;">name</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">io.dcloud.common.util.DCloud_FileProvider</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#50FA7B;font-style:italic;">android</span><span style="color:#FF79C6;font-style:italic;">:</span><span style="color:#50FA7B;font-style:italic;">authorities</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">uni.UNI2A4F113.dc.fileprovider</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#50FA7B;font-style:italic;">android</span><span style="color:#FF79C6;font-style:italic;">:</span><span style="color:#50FA7B;font-style:italic;">exported</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">false</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#50FA7B;font-style:italic;">android</span><span style="color:#FF79C6;font-style:italic;">:</span><span style="color:#50FA7B;font-style:italic;">grantUriPermissions</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">true</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">  &lt;</span><span style="color:#FF79C6;">meta-data</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">android</span><span style="color:#FF79C6;font-style:italic;">:</span><span style="color:#50FA7B;font-style:italic;">name</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">android.support.FILE_PROVIDER_PATHS</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">android</span><span style="color:#FF79C6;font-style:italic;">:</span><span style="color:#50FA7B;font-style:italic;">resource</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">@xml/dcloud_file_provider</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> /&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;/</span><span style="color:#FF79C6;">provider</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>注意当前应用的包名<code>uni.UNI2A4F113</code></p><ol start="5"><li>配置 Appkey</li></ol><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">meta-data</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">android</span><span style="color:#FF79C6;font-style:italic;">:</span><span style="color:#50FA7B;font-style:italic;">name</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">dcloud_appkey</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">android</span><span style="color:#FF79C6;font-style:italic;">:</span><span style="color:#50FA7B;font-style:italic;">value</span><span style="color:#F8F8F2;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">你申请的key</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> /&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="打包" tabindex="-1">打包 <a class="header-anchor" href="#打包" aria-label="Permalink to &quot;打包&quot;">​</a></h3><p>配置完成后，点击打包图标，等待打包，然后会生成一个 apk 文件，安装到手机里即可</p>`,49),e=[o];function F(t,c,r,i,y,d){return n(),a("div",null,e)}const A=s(p,[["render",F]]);export{C as __pageData,A as default};
