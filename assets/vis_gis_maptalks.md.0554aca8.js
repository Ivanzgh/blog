import{_ as s,c as n,o as a,Q as l}from"./chunks/framework.f14b72c3.js";const m=JSON.parse('{"title":"Maptalks","description":"","frontmatter":{},"headers":[],"relativePath":"vis/gis/maptalks.md","lastUpdated":1695604450000}'),p={name:"vis/gis/maptalks.md"},o=l(`<h1 id="maptalks" tabindex="-1">Maptalks <a class="header-anchor" href="#maptalks" aria-label="Permalink to &quot;Maptalks&quot;">​</a></h1><h2 id="tooltip" tabindex="-1">ToolTip <a class="header-anchor" href="#tooltip" aria-label="Permalink to &quot;ToolTip&quot;">​</a></h2><p>先初始化地图，然后生成一个点，鼠标移入显示提示信息，使用<code>ToolTip</code>或者<code>InfoWindow</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> map </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;font-weight:bold;">new</span><span style="color:#F8F8F2;"> maptalks.</span><span style="color:#50FA7B;">Map</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">map</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, {</span></span>
<span class="line"><span style="color:#F8F8F2;">  center</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> [</span><span style="color:#BD93F9;">118.5120580992</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">38.5709155036</span><span style="color:#F8F8F2;">],</span></span>
<span class="line"><span style="color:#F8F8F2;">  zoom</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">5</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  minZoom</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  maxZoom</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">18</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  seamlessZoom</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">false</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">  spatialReference</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> { projection</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">baidu</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;"> },</span></span>
<span class="line"><span style="color:#F8F8F2;">  baseLayer</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;font-weight:bold;">new</span><span style="color:#F8F8F2;"> maptalks.</span><span style="color:#50FA7B;">TileLayer</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">base</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, {</span></span>
<span class="line"><span style="color:#F8F8F2;">    urlTemplate</span><span style="color:#FF79C6;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">http://online{s}.map.bdimg.com/onlinelabel/?qt=tile&amp;x={x}&amp;y={y}&amp;z={z}&amp;styles=pl&amp;scaler=1&amp;p=1</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    subdomains</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> [</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">3</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">4</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">5</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">6</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">7</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">8</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">9</span><span style="color:#F8F8F2;">],</span></span>
<span class="line"><span style="color:#F8F8F2;">    attribution</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">&amp;copy; &lt;a target=&quot;_blank&quot; href=&quot;http://map.baidu.com&quot;&gt;Baidu&lt;/a&gt;</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">  })</span></span>
<span class="line"><span style="color:#F8F8F2;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> point </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;font-weight:bold;">new</span><span style="color:#F8F8F2;"> maptalks.</span><span style="color:#50FA7B;">Marker</span><span style="color:#F8F8F2;">([info.lng, info.lat], {</span></span>
<span class="line"><span style="color:#F8F8F2;">  symbol</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    markerFile</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">foo.png</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    markerWidth</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">24</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    markerHeight</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">30</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">})</span></span>
<span class="line"><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> toolTip </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;font-weight:bold;">new</span><span style="color:#F8F8F2;"> maptalks.ui.</span><span style="color:#50FA7B;">ToolTip</span><span style="color:#F8F8F2;">(</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#F1FA8C;">\`&lt;div style=&#39;color: #000; width:200px; background:#fff; opacity:0.8;padding:6px;&#39;&gt;</span></span>
<span class="line"><span style="color:#F1FA8C;">        &lt;div&gt;船名：</span><span style="color:#FF79C6;">\${</span><span style="color:#F8F8F2;">info.cnName</span><span style="color:#F1FA8C;"> </span><span style="color:#FF79C6;">?</span><span style="color:#F1FA8C;"> </span><span style="color:#F8F8F2;">info.cnName</span><span style="color:#F1FA8C;"> </span><span style="color:#FF79C6;">:</span><span style="color:#F1FA8C;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">-</span><span style="color:#E9F284;">&#39;</span><span style="color:#FF79C6;">}</span><span style="color:#F1FA8C;">&lt;/div&gt;&lt;div&gt;MMSI：</span><span style="color:#FF79C6;">\${</span><span style="color:#F8F8F2;">info.mmsi</span><span style="color:#FF79C6;">}</span><span style="color:#F1FA8C;">&lt;/div&gt;</span></span>
<span class="line"><span style="color:#F1FA8C;">        &lt;div&gt;时间：</span><span style="color:#FF79C6;">\${</span></span>
<span class="line"><span style="color:#F1FA8C;">          </span><span style="color:#F8F8F2;">info.updateTime</span><span style="color:#F1FA8C;"> </span><span style="color:#FF79C6;">?</span><span style="color:#F1FA8C;"> </span><span style="color:#50FA7B;">moment</span><span style="color:#F8F8F2;">(info.updateTime).</span><span style="color:#50FA7B;">format</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">YYYY-MM-DD HH:mm:ss</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span><span style="color:#F1FA8C;"> </span><span style="color:#FF79C6;">:</span><span style="color:#F1FA8C;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">-</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F1FA8C;">        </span><span style="color:#FF79C6;">}</span><span style="color:#F1FA8C;">&lt;/div&gt;&lt;/div&gt;\`</span></span>
<span class="line"><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">toolTip.</span><span style="color:#50FA7B;">setStyle</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">tip</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">toolTip.</span><span style="color:#50FA7B;">addTo</span><span style="color:#F8F8F2;">(point)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">// const infoWindow = new maptalks.ui.InfoWindow({</span></span>
<span class="line"><span style="color:#6272A4;">//   single: false,</span></span>
<span class="line"><span style="color:#6272A4;">//   width: 200,</span></span>
<span class="line"><span style="color:#6272A4;">//   height: 180,</span></span>
<span class="line"><span style="color:#6272A4;">//   custom: true,</span></span>
<span class="line"><span style="color:#6272A4;">//   dx: -100,</span></span>
<span class="line"><span style="color:#6272A4;">//   dy: -3,</span></span>
<span class="line"><span style="color:#6272A4;">//   content: \`&lt;div style=&#39;color: #000; width:200px; background:#fff; opacity:0.8;padding:6px;&#39;&gt;</span></span>
<span class="line"><span style="color:#6272A4;">//   &lt;div&gt;船名：\${info.cnName ? info.cnName : &#39;-&#39;}&lt;/div&gt;&lt;div&gt;MMSI：\${info.mmsi}&lt;/div&gt;</span></span>
<span class="line"><span style="color:#6272A4;">//   &lt;div&gt;时间：\${info.updateTime ? moment(info.updateTime).format(&#39;YYYY-MM-DD HH:mm:ss&#39;) : &#39;-&#39;}&lt;/div&gt;&lt;/div&gt;\`</span></span>
<span class="line"><span style="color:#6272A4;">// })</span></span>
<span class="line"><span style="color:#6272A4;">// infoWindow.addTo(map)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;">// point.on(&#39;mouseover&#39;, () =&gt; {</span></span>
<span class="line"><span style="color:#6272A4;">//   infoWindow.show({ x: info.lng, y: info.lat })</span></span>
<span class="line"><span style="color:#6272A4;">// })</span></span>
<span class="line"><span style="color:#6272A4;">// point.on(&#39;mouseout&#39;, () =&gt; {</span></span>
<span class="line"><span style="color:#6272A4;">//   infoWindow.hide()</span></span>
<span class="line"><span style="color:#6272A4;">// })</span></span>
<span class="line"><span style="color:#FF79C6;font-weight:bold;">new</span><span style="color:#F8F8F2;"> maptalks.</span><span style="color:#50FA7B;">VectorLayer</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">vector</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, point).</span><span style="color:#50FA7B;">addTo</span><span style="color:#F8F8F2;">(map)</span></span>
<span class="line"></span></code></pre></div><h2 id="计算船舶点位角度" tabindex="-1">计算船舶点位角度 <a class="header-anchor" href="#计算船舶点位角度" aria-label="Permalink to &quot;计算船舶点位角度&quot;">​</a></h2><ul><li>maptalks 默认以正东为起始角度，逆时针旋转为正方向</li><li>船首向以正北为起始角度，顺时针旋转为正方向</li><li>marker 点位默认就有 90 度</li></ul><p>所以在设置船舶图标方向时，直接将船首向（heading）取反即可，<code>markerRotation: -heading</code></p><h2 id="设置-svg-点位图标" tabindex="-1">设置 svg 点位图标 <a class="header-anchor" href="#设置-svg-点位图标" aria-label="Permalink to &quot;设置 svg 点位图标&quot;">​</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">getShipPath</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">function</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">s</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> [</span></span>
<span class="line"><span style="color:#F8F8F2;">    {</span></span>
<span class="line"><span style="color:#F8F8F2;">      path</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">M422.976017 76.166077l244.036492 927.338671h-488.072985l244.036493-927.338671z m0 0</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">stroke-width</span><span style="color:#E9F284;">&#39;</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">2</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      stroke</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> s,</span></span>
<span class="line"><span style="color:#F8F8F2;">      fill</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#f4ea2a</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    },</span></span>
<span class="line"><span style="color:#F8F8F2;">    {</span></span>
<span class="line"><span style="color:#F8F8F2;">      path</span><span style="color:#FF79C6;">:</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">M692.369426 1024H153.582608L422.976017 0 692.369426 1024z m-488.072985-39.083969h437.359151L422.976017 153.285422 204.296441 984.916031z m0 0</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">stroke-width</span><span style="color:#E9F284;">&#39;</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">6</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      stroke</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> s,</span></span>
<span class="line"><span style="color:#F8F8F2;">      fill</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#f4ea2a</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">  ]</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">shipSymbol</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">function</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">lineColor</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> symbol </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> [</span></span>
<span class="line"><span style="color:#F8F8F2;">    {</span></span>
<span class="line"><span style="color:#F8F8F2;">      markerType</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">path</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      markerPath</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">getShipPath</span><span style="color:#F8F8F2;">(lineColor),</span></span>
<span class="line"><span style="color:#F8F8F2;">      markerPathWidth</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1024</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      markerPathHeight</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1024</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      markerWidth</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">24</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      markerHeight</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">30</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      markerDy</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">15</span><span style="color:#F8F8F2;">, </span><span style="color:#6272A4;">// height的一半</span></span>
<span class="line"><span style="color:#F8F8F2;">      markerDx</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">2</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">  ]</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> symbol</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><p><code>markerPathWidth</code>和<code>markerPathHeight</code>表示 svg 的 <code>viewBox</code> 属性， 允许指定一个给定的一组图形伸展以适应特定的容器元素。</p><p>经纬度位置在图片图标的正中心，在 svg 图标的下方，所以需要沿 y 轴偏移图标高度的一半</p>`,11),F=[o];function e(t,c,r,y,i,d){return a(),n("div",null,F)}const h=s(p,[["render",e]]);export{m as __pageData,h as default};
