import{_ as s,c as n,o as a,Q as l}from"./chunks/framework.f14b72c3.js";const h=JSON.parse('{"title":"Nginx","description":"","frontmatter":{},"headers":[],"relativePath":"be/nginx.md","lastUpdated":1688050449000}'),p={name:"be/nginx.md"},o=l(`<h1 id="nginx" tabindex="-1">Nginx <a class="header-anchor" href="#nginx" aria-label="Permalink to &quot;Nginx&quot;">​</a></h1><h2 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-label="Permalink to &quot;安装&quot;">​</a></h2><p>地址： <a href="http://nginx.org/en/download.html" target="_blank" rel="noreferrer">http://nginx.org/en/download.html</a></p><p><img src="https://zghimg.oss-cn-beijing.aliyuncs.com/blog/1666418409.png" alt="image"></p><p>Mainline version：最新版本</p><p>Stable version：稳定版，生产环境上建议使用这个版本</p><p>Legacy versions：历史版本</p><h2 id="介绍" tabindex="-1">介绍 <a class="header-anchor" href="#介绍" aria-label="Permalink to &quot;介绍&quot;">​</a></h2><p>Nginx 就是反向代理服务器。</p><p>代理服务器一般是指局域网内部的机器通过代理服务发送请求到互联网上的服务器，代理服务器一般作用于客户端。</p><p><img src="https://zghimg.oss-cn-beijing.aliyuncs.com/blog/1666418432.png" alt="image"></p><p>简单的说：</p><p>正向代理：客户端知道服务器端，通过代理端连接服务器端。代理端代理的是服务器端。</p><p>反向代理：服务器端知道客户端，客户端不知道服务器端，通过代理端连接服务器端。代理端代理的是客户端，代理对象刚好相反，所以叫反向代理。</p><h2 id="命令" tabindex="-1">命令 <a class="header-anchor" href="#命令" aria-label="Permalink to &quot;命令&quot;">​</a></h2><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki dracula"><code><span class="line"><span style="color:#6272A4;"># 重新加载资源</span></span>
<span class="line"><span style="color:#F8F8F2;">nginx </span><span style="color:#BD93F9;">-s</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">reload</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 重启</span></span>
<span class="line"><span style="color:#F8F8F2;">nginx </span><span style="color:#BD93F9;">-s</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">reopen</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4;"># 停止</span></span>
<span class="line"><span style="color:#F8F8F2;">nginx </span><span style="color:#BD93F9;">-s</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">stop</span></span>
<span class="line"></span></code></pre></div><h2 id="设置-windows-下-nginx-开机自启" tabindex="-1">设置 windows 下 nginx 开机自启 <a class="header-anchor" href="#设置-windows-下-nginx-开机自启" aria-label="Permalink to &quot;设置 windows 下 nginx 开机自启&quot;">​</a></h2><p>首先下载 <code>winsw</code> 工具</p><p>地址：<a href="http://repo.jenkins-ci.org/releases/com/sun/winsw/winsw/" target="_blank" rel="noreferrer">http://repo.jenkins-ci.org/releases/com/sun/winsw/winsw/</a><br> 例如下载 <code>V2.9.0</code> 则选择 <code>winsw-2.9.0-net4.exe</code></p><p>或者 <a href="https://github.com/winsw/winsw/releases" target="_blank" rel="noreferrer">https://github.com/winsw/winsw/releases</a> ，选择 <code>WinSW.NET4.exe</code> 表示 64 位</p><p>将下载的 <code>winsw</code> 移动到 nginx 的安装目录,并将 <code>winsw</code> 工具改名为 <code>nginx-service.exe</code></p><p>然后在 nginx 安装目录下新建文件 <code>nginx-service.xml</code>，<code>logpath</code> 标签里设置 Nginx 的安装位置</p><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">service</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">id</span><span style="color:#F8F8F2;">&gt;nginx&lt;/</span><span style="color:#FF79C6;">id</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">name</span><span style="color:#F8F8F2;">&gt;nginx&lt;/</span><span style="color:#FF79C6;">name</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">description</span><span style="color:#F8F8F2;">&gt;nginx&lt;/</span><span style="color:#FF79C6;">description</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">logpath</span><span style="color:#F8F8F2;">&gt;D:\\nginx-1.19.0&lt;/</span><span style="color:#FF79C6;">logpath</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">logmode</span><span style="color:#F8F8F2;">&gt;roll&lt;/</span><span style="color:#FF79C6;">logmode</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">depend</span><span style="color:#F8F8F2;">&gt;&lt;/</span><span style="color:#FF79C6;">depend</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">executable</span><span style="color:#F8F8F2;">&gt;D:\\nginx-1.19.0\\nginx.exe&lt;/</span><span style="color:#FF79C6;">executable</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">stopexecutable</span><span style="color:#F8F8F2;">&gt;D:\\nginx-1.19.0\\nginx.exe -s stop&lt;/</span><span style="color:#FF79C6;">stopexecutable</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;/</span><span style="color:#FF79C6;">service</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>打开 <code>cmd</code>，进入 Nginx 安装目录，输入 <code>nginx-service.exe install</code> ，将其注册为 Windows 服务。</p><p>然后运行 <code>nginx-service.exe start</code> 启动服务</p><p><code>win + R</code> 输入 <code>service.msc</code> 打开系统服务，查看 Nginx 服务，启动类型为自动即成功开启服务。</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">nginx-service.exe </span><span style="color:#F1FA8C;">install</span><span style="color:#F8F8F2;">      </span><span style="color:#F1FA8C;">注册对应的系统服务</span></span>
<span class="line"><span style="color:#F8F8F2;">nginx-service.exe </span><span style="color:#F1FA8C;">uninstall</span><span style="color:#F8F8F2;">    </span><span style="color:#F1FA8C;">删除对应的系统服务</span></span>
<span class="line"><span style="color:#F8F8F2;">nginx-service.exe </span><span style="color:#F1FA8C;">stop</span><span style="color:#F8F8F2;">         </span><span style="color:#F1FA8C;">停止对应的系统服务</span></span>
<span class="line"><span style="color:#F8F8F2;">nginx-service.exe </span><span style="color:#F1FA8C;">start</span><span style="color:#F8F8F2;">        </span><span style="color:#F1FA8C;">启动对应的系统服务</span></span>
<span class="line"></span></code></pre></div><h2 id="配置-nginx-conf-文件" tabindex="-1">配置 nginx.conf 文件 <a class="header-anchor" href="#配置-nginx-conf-文件" aria-label="Permalink to &quot;配置 nginx.conf 文件&quot;">​</a></h2><p>在 http/server 里添加如下内容，</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">location </span><span style="color:#F1FA8C;">/</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">#root   D:\\dist;</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">#index  index.html index.htm;</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"><span style="color:#F8F8F2;">location </span><span style="color:#F1FA8C;">/services/tilt</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FD;">alias</span><span style="color:#F8F8F2;">   </span><span style="color:#F1FA8C;">D:</span><span style="color:#FF79C6;">\\d</span><span style="color:#F1FA8C;">ata</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">    add_header </span><span style="color:#F1FA8C;">Access-Control-Allow-Origin</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">*</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">    add_header </span><span style="color:#F1FA8C;">Access-Control-Allow-Headers</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">Origin, X-Requested-With, Content-Type, Accept</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">    add_header </span><span style="color:#F1FA8C;">Access-Control-Allow-Methods</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">GET, POST, OPTIONS</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">    fastcgi_hide_header </span><span style="color:#F1FA8C;">Cache-Control</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">    proxy_hide_header </span><span style="color:#F1FA8C;">Cache-Control</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">    add_header </span><span style="color:#F1FA8C;">Cache-Control</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">private</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">    fastcgi_hide_header </span><span style="color:#F1FA8C;">Pragma</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">    proxy_hide_header </span><span style="color:#F1FA8C;">Pragma</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"><span style="color:#F8F8F2;">gzip  </span><span style="color:#F1FA8C;">on</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">gzip_min_length </span><span style="color:#F1FA8C;">1k</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">gzip_buffers </span><span style="color:#BD93F9;">4</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">16k</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">gzip_http_version </span><span style="color:#BD93F9;">1.0</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">gzip_comp_level </span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">gzip_types </span><span style="color:#F1FA8C;">text/plain</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">application/javascript</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">application/css</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">application/json</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">text/css</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">application/xml</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">text/javascript</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">application/x-httpd-php</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">image/jpeg</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">image/gif</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">image/png</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">gzip_vary </span><span style="color:#F1FA8C;">off</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">gzip_disable </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">MSIE [1-6]\\.</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"></span></code></pre></div><blockquote><p><strong>alias D:\\data</strong> 指定文件路径，即本地要托管的数据。如果文件名以 n 开头，因为\\n 会导致换行和路径错误，所以要使用\\n 或者使用斜杠，如 D:/ndata</p></blockquote><p>启动 nginx，比如要模拟生产环境，将项目打包后的文件托管到 nginx 服务，打开<a href="http://127.0.0.1" target="_blank" rel="noreferrer">http://127.0.0.1</a>即可查看。</p><p>打开<a href="http://127.0.0.1/services/tilt/yizhuang/tileset.json" target="_blank" rel="noreferrer">http://127.0.0.1/services/tilt/yizhuang/tileset.json</a> 即可看到 D 盘里 data 文件夹下的数据。</p><p>此处<a href="http://127.0.0.1/services/tilt" target="_blank" rel="noreferrer">http://127.0.0.1/services/tilt</a>是 nginx 暴露出去的路径，后边的/yizhuang/tileset.json 是由 D:\\data 里的内容决定的</p>`,34),e=[o];function t(F,c,r,i,y,d){return a(),n("div",null,e)}const x=s(p,[["render",t]]);export{h as __pageData,x as default};
