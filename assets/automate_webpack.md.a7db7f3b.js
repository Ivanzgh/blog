import{_ as s,c as a,o as n,Q as l}from"./chunks/framework.f14b72c3.js";const b=JSON.parse('{"title":"Webpack","description":"","frontmatter":{},"headers":[],"relativePath":"automate/webpack.md","lastUpdated":1685193505000}'),p={name:"automate/webpack.md"},o=l(`<h1 id="webpack" tabindex="-1">Webpack <a class="header-anchor" href="#webpack" aria-label="Permalink to &quot;Webpack&quot;">​</a></h1><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><strong>目标</strong>：学会使用 Webpack 进行前端项目的打包和优化。</p><p><strong>关键结果</strong>：</p><ol><li>完成 Webpack 的基础学习，包括 Webpack 的安装、配置和使用方法。</li><li>能够使用 Webpack 进行前端项目的打包和优化，包括代码分割、压缩、模块化等。</li><li>实践使用 Webpack 进行前端项目的开发，包括搭建开发环境、打包发布等。</li><li>学习 Webpack 的高级特性，包括插件开发、性能优化等。</li><li>完成一个基于 Webpack 的前端项目，包括开发、打包、发布等环节。</li></ol><p><strong>时间安排</strong>：</p><ol><li>第一周：学习 Webpack 的基础知识，完成 Webpack 的安装和配置。</li><li>第二周：学习 Webpack 的打包和优化方法，完成代码分割、压缩、模块化等操作。</li><li>第三周：实践使用 Webpack 进行前端项目的开发，包括搭建开发环境、打包发布等。</li><li>第四周：学习 Webpack 的高级特性，包括插件开发、性能优化等。</li><li>第五周：完成一个基于 Webpack 的前端项目，包括开发、打包、发布等环节。</li></ol><p><strong>备注</strong>：</p><p>每周需要安排 5-10 小时的学习时间，可以通过阅读文档、视频教程、实践操作等方式进行学习。同时，需要定期进行总结和复习，以确保学习效果。</p></div><h2 id="简介" tabindex="-1">简介 <a class="header-anchor" href="#简介" aria-label="Permalink to &quot;简介&quot;">​</a></h2><p>官网：<a href="https://webpack.js.org/" target="_blank" rel="noreferrer">https://webpack.js.org/</a></p><h2 id="依赖分析和-cdn-加速" tabindex="-1">依赖分析和 CDN 加速 <a class="header-anchor" href="#依赖分析和-cdn-加速" aria-label="Permalink to &quot;依赖分析和 CDN 加速&quot;">​</a></h2><p>这里以 Vue 项目打包优化为例，减少打包体积，生产环境使用 CDN 加速</p><h3 id="依赖分析" tabindex="-1">依赖分析 <a class="header-anchor" href="#依赖分析" aria-label="Permalink to &quot;依赖分析&quot;">​</a></h3><p>依赖分析可以看出项目中各个依赖所占的打包体积，辅助分析可以优化的地方。</p><p>1、安装<code>webpack-bundle-analyzer</code>插件，<a href="https://github.com/webpack-contrib/webpack-bundle-analyzer" target="_blank" rel="noreferrer">仓库地址</a></p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">npm </span><span style="color:#F1FA8C;">i</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">-D</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">webpack-bundle-analyzer</span></span>
<span class="line"></span></code></pre></div><p>2、在<code>package.json</code>中配置分析命令：<code>build:analyze</code>，这里定义一个<code>ANALYZE_MODE</code>字段，并设置为 <code>true</code></p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#8BE9FE;">&quot;</span><span style="color:#8BE9FD;">scripts</span><span style="color:#8BE9FE;">&quot;</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FE;">&quot;</span><span style="color:#8BE9FD;">dev</span><span style="color:#8BE9FE;">&quot;</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">vue-cli-service serve</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FE;">&quot;</span><span style="color:#8BE9FD;">build:prod</span><span style="color:#8BE9FE;">&quot;</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">vue-cli-service build</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#8BE9FE;">&quot;</span><span style="color:#8BE9FD;">build:analyze</span><span style="color:#8BE9FE;">&quot;</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">ANALYZE_MODE=true vue-cli-service build --mode analyze</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><p>3、配置<code>vue.config.js</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> BundleAnalyzerPlugin </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">require</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">webpack-bundle-analyzer</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">).BundleAnalyzerPlugin;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8BE9FD;font-style:italic;">module</span><span style="color:#F8F8F2;">.</span><span style="color:#8BE9FD;font-style:italic;">exports</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#50FA7B;">chainWebpack</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">config</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">// 依赖分析</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> (p<wbr>rocess.env.</span><span style="color:#BD93F9;">ANALYZE_MODE</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">      config.</span><span style="color:#50FA7B;">plugin</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">webpack-bundle-analyzer</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">).</span><span style="color:#50FA7B;">use</span><span style="color:#F8F8F2;">(BundleAnalyzerPlugin);</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    config.</span><span style="color:#50FA7B;">when</span><span style="color:#F8F8F2;">(p<wbr>rocess.env.</span><span style="color:#BD93F9;">NODE_ENV</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">!==</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">development</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, (</span><span style="color:#FFB86C;font-style:italic;">config</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#6272A4;">// 设置哪些资源不需要被打包，改为获取CDN资源</span></span>
<span class="line"><span style="color:#F8F8F2;">      config.</span><span style="color:#50FA7B;">set</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">externals</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, {</span></span>
<span class="line"><span style="color:#F8F8F2;">        vue</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">Vue</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">vue-router</span><span style="color:#E9F284;">&#39;</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">VueRouter</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">        vuex</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">Vuex</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">        axios</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">axios</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">element-ui</span><span style="color:#E9F284;">&#39;</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">ELEMENT</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">      });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#6272A4;">// 给 index.html 传参</span></span>
<span class="line"><span style="color:#F8F8F2;">      config.</span><span style="color:#50FA7B;">plugin</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">html</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">).</span><span style="color:#50FA7B;">tap</span><span style="color:#F8F8F2;">((</span><span style="color:#FFB86C;font-style:italic;">args</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">        args[</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">].useCdn </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">true</span><span style="color:#F8F8F2;">;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> args;</span></span>
<span class="line"><span style="color:#F8F8F2;">      });</span></span>
<span class="line"><span style="color:#F8F8F2;">    });</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">};</span></span>
<span class="line"></span></code></pre></div><p>关于<a href="https://webpack.js.org/configuration/externals/#root" target="_blank" rel="noreferrer">externals</a>，<code>{ key: value }</code>，其中 key 是第三方依赖库的名称，和<code>package.json</code> 文件中的依赖名称一样。关于 value 的值，先把 CDN 的链接打开查看源代码，一般就是暴露出来的全局变量名称</p><p>4、配置 index.html 模板，引入 CDN 链接</p><p><a href="https://cli.vuejs.org/zh/guide/html-and-static-assets.html" target="_blank" rel="noreferrer">配置参考链接</a></p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF5555;font-style:italic;text-decoration:underline;">&lt;</span><span style="color:#F8F8F2;">% if(htmlWebpackPlugin.options.useCdn==true) { %&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">script</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">src</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">&gt;&lt;/</span><span style="color:#FF79C6;">script</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">script</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">src</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">https://cdn.jsdelivr.net/npm/vue-router@3.5.4/dist/vue-router.global.min.js</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">&gt;&lt;/</span><span style="color:#FF79C6;">script</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">script</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">src</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">https://cdn.jsdelivr.net/npm/axios@1.3.6/dist/axios.min.js</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">&gt;&lt;/</span><span style="color:#FF79C6;">script</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#FF5555;font-style:italic;text-decoration:underline;">&lt;</span><span style="color:#F8F8F2;">% } %&gt;</span></span>
<span class="line"></span></code></pre></div><p>常见的 CDN 提供商：<a href="https://www.jsdelivr.com/" target="_blank" rel="noreferrer">jsdelivr</a>、<a href="https://cdnjs.com/libraries" target="_blank" rel="noreferrer">cdnjs</a>、<a href="https://www.bootcdn.cn/" target="_blank" rel="noreferrer">bootcdn</a>、<a href="https://unpkg.com/" target="_blank" rel="noreferrer">unpkg</a></p><p>如果有自建 CDN 服务，可以从 jsdelivr 上面下载各个库、各个版本的源码</p><p>5、执行命令，查看项目依赖体积情况</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">npm </span><span style="color:#F1FA8C;">run</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">build:analyze</span></span>
<span class="line"></span></code></pre></div><h2 id="gzip-压缩" tabindex="-1">GZIP 压缩 <a class="header-anchor" href="#gzip-压缩" aria-label="Permalink to &quot;GZIP 压缩&quot;">​</a></h2><h2 id="项目生成目录结构" tabindex="-1">项目生成目录结构 <a class="header-anchor" href="#项目生成目录结构" aria-label="Permalink to &quot;项目生成目录结构&quot;">​</a></h2><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">npm </span><span style="color:#F1FA8C;">install</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">mddir</span></span>
<span class="line"></span></code></pre></div><p>进入目录：<code>cd node_modules/mddir/src</code></p><p>执行：<code>node mddir &#39;../../../src</code>，这里是只生成 src 目录下的结构，如果要生成全部的目录就去掉 src</p><p>执行之后得到一个<code>directoryList.md</code>文件，在<code>node_modules/mddir/src</code>路径下， 拷贝内容之后记得删除依赖</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">npm </span><span style="color:#F1FA8C;">install</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">mddir</span></span>
<span class="line"></span></code></pre></div><p>如果需要忽略特定文件，可以在忽略规则中指定文件路径，例如：</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">node </span><span style="color:#F1FA8C;">mddir</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">--</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">ignore</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">node_modules|dist|/src/api/</span><span style="color:#E9F284;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>上面的命令将忽略<code>node_modules</code>、<code>dist</code>、<code>/src/api</code>目录下的文件</p><h2 id="" tabindex="-1"><a class="header-anchor" href="#" aria-label="Permalink to &quot;&quot;">​</a></h2>`,33),e=[o];function t(c,F,r,y,i,d){return n(),a("div",null,e)}const h=s(p,[["render",t]]);export{b as __pageData,h as default};
