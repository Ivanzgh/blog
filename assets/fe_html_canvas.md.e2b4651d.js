import{_ as s,c as a,o as n,Q as l}from"./chunks/framework.f14b72c3.js";const B=JSON.parse('{"title":"Canvas","description":"","frontmatter":{},"headers":[],"relativePath":"fe/html/canvas.md","lastUpdated":1695604450000}'),p={name:"fe/html/canvas.md"},o=l(`<h1 id="canvas" tabindex="-1">Canvas <a class="header-anchor" href="#canvas" aria-label="Permalink to &quot;Canvas&quot;">​</a></h1><h2 id="介绍" tabindex="-1">介绍 <a class="header-anchor" href="#介绍" aria-label="Permalink to &quot;介绍&quot;">​</a></h2><p>canvas 是绘制图形的。</p><p>canvas 是一个二维网格。左上角坐标为 <code>(0,0)</code></p><p>首先创建一个画布</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">canvas</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">id</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">cvs</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">width</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">1000</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">height</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">800</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">&gt;&lt;/</span><span style="color:#FF79C6;">canvas</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>然后获取到画布和二维模型</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> canvas </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> document.</span><span style="color:#50FA7B;">getElementById</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">cvs</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> ctx </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> canvas.</span><span style="color:#50FA7B;">getContext</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">2d</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span></code></pre></div><p>ctx 就相当于画笔了</p><h3 id="检查支持性" tabindex="-1">检查支持性 <a class="header-anchor" href="#检查支持性" aria-label="Permalink to &quot;检查支持性&quot;">​</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> canvas </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> document.</span><span style="color:#50FA7B;">getElementById</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">cvs</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> (canvas.getContext) {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#6272A4;">// 支持canvas</span></span>
<span class="line"><span style="color:#F8F8F2;">} </span><span style="color:#FF79C6;">else</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#6272A4;">// 不支持canvas</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="大小" tabindex="-1">大小 <a class="header-anchor" href="#大小" aria-label="Permalink to &quot;大小&quot;">​</a></h3><p>canvas 默认大小是宽度 300px，高度 150px。不能设置百分比，不能通过 css 设置宽高</p><p>方式一、直接设置 width 和 height 属性</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">canvas</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">id</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">cvs</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">width</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">1000</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">height</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">800</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">&gt;&lt;/</span><span style="color:#FF79C6;">canvas</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>方式二、通过 js 设置</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> canvas </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> document.</span><span style="color:#50FA7B;">getElementById</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">cvs</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> ctx </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> canvas.</span><span style="color:#50FA7B;">getContext</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">2d</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.width </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1000</span><span style="color:#F8F8F2;"> </span><span style="color:#6272A4;">// 可以不写单位px</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.height </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">800</span></span>
<span class="line"></span></code></pre></div><p>如果想动态设置宽高，比如想让 canvas 的宽度占据屏幕的 70%，根据<code>16:9</code>的比例计算高度</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> canvasWidth </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> window.innerWidth </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0.7</span></span>
<span class="line"><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> canvasHeight </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> (canvasWidth </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">9</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">/</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">16</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">ctx.width </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> canvasWidth</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.height </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> canvasHeight</span></span>
<span class="line"></span></code></pre></div><h2 id="线" tabindex="-1">线 <a class="header-anchor" href="#线" aria-label="Permalink to &quot;线&quot;">​</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">moveTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">10</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">20</span><span style="color:#F8F8F2;">) </span><span style="color:#6272A4;">// 定义起点</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">lineTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">50</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">100</span><span style="color:#F8F8F2;">) </span><span style="color:#6272A4;">// 定义终点</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.strokeStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#f00</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;"> </span><span style="color:#6272A4;">// 线的颜色</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">stroke</span><span style="color:#F8F8F2;">() </span><span style="color:#6272A4;">// 画线</span></span>
<span class="line"></span></code></pre></div><p>注意<strong>设置样式要在绘制之前，否则无效</strong></p><p>画个树：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">beginPath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">moveTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">500</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">50</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">lineTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">300</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">200</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">lineTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">450</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">200</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">lineTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">200</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">300</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">lineTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">450</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">300</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">lineTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">450</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">400</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">lineTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">550</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">400</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">lineTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">550</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">300</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">lineTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">770</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">300</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">lineTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">550</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">200</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">lineTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">700</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">200</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.fillStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#0f0</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">fill</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.strokeStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#0f0</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">stroke</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">closePath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"></span></code></pre></div><p>电子画笔</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> canvas </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> document.</span><span style="color:#50FA7B;">getElementById</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">canvas</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> ctx </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> canvas.</span><span style="color:#50FA7B;">getContext</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">2d</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> drawStatus </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">false</span></span>
<span class="line"><span style="color:#F8F8F2;">canvas.</span><span style="color:#50FA7B;">onmousedown</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> (</span><span style="color:#FFB86C;font-style:italic;">e</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  ctx.</span><span style="color:#50FA7B;">moveTo</span><span style="color:#F8F8F2;">(e.offsetX, e.offsetY)</span></span>
<span class="line"><span style="color:#F8F8F2;">  drawStatus </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">true</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"><span style="color:#F8F8F2;">canvas.</span><span style="color:#50FA7B;">onmouseup</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> () </span><span style="color:#FF79C6;">=&gt;</span><span style="color:#F8F8F2;"> (drawStatus </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">false</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">canvas.</span><span style="color:#50FA7B;">onmouseout</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> () </span><span style="color:#FF79C6;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> (drawStatus) {</span></span>
<span class="line"><span style="color:#F8F8F2;">    drawStatus </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">false</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"><span style="color:#F8F8F2;">canvas.</span><span style="color:#50FA7B;">onmousemove</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> (</span><span style="color:#FFB86C;font-style:italic;">e</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> (drawStatus) {</span></span>
<span class="line"><span style="color:#F8F8F2;">    ctx.</span><span style="color:#50FA7B;">lineTo</span><span style="color:#F8F8F2;">(e.offsetX, e.offsetY)</span></span>
<span class="line"><span style="color:#F8F8F2;">    ctx.</span><span style="color:#50FA7B;">stroke</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="二次贝塞尔曲线" tabindex="-1">二次贝塞尔曲线 <a class="header-anchor" href="#二次贝塞尔曲线" aria-label="Permalink to &quot;二次贝塞尔曲线&quot;">​</a></h3><p>二次贝塞尔曲线有一个开始点、一个结束点以及一个控制点</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#50FA7B;">quadraticCurveTo</span><span style="color:#F8F8F2;">(cp1x, cp1y, x, y) </span><span style="color:#6272A4;">// cp1x,cp1y为一个控制点，x,y为结束点</span></span>
<span class="line"></span></code></pre></div><p>示例：对钩</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">beginPath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">moveTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">500</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">400</span><span style="color:#F8F8F2;">) </span><span style="color:#6272A4;">// 如果不设置，那么起始点位置就在控制点，视觉上就是绘制了一条直线</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">quadraticCurveTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">500</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">600</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">900</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">400</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">stroke</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">closePath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"></span></code></pre></div><h3 id="三次贝塞尔曲线" tabindex="-1">三次贝塞尔曲线 <a class="header-anchor" href="#三次贝塞尔曲线" aria-label="Permalink to &quot;三次贝塞尔曲线&quot;">​</a></h3><p>三次贝塞尔曲线有两个控制点</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#50FA7B;">bezierCurveTo</span><span style="color:#F8F8F2;">(cp1x, cp1y, cp2x, cp2y, x, y) </span><span style="color:#6272A4;">// cp1x,cp1y为控制点一，cp2x,cp2y为控制点二，x,y为结束点</span></span>
<span class="line"></span></code></pre></div><p>示例：红色爱心</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">beginPath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">moveTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">75</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">40</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">bezierCurveTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">75</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">37</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">70</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">25</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">50</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">25</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">bezierCurveTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">20</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">25</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">20</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">62.5</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">20</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">62.5</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">bezierCurveTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">20</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">80</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">40</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">102</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">75</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">120</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">bezierCurveTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">110</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">102</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">130</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">80</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">130</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">62.5</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">bezierCurveTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">130</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">62.5</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">130</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">25</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">100</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">25</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">bezierCurveTo</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">85</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">25</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">75</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">37</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">75</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">40</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.fillStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#f00</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">fill</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"></span></code></pre></div><h2 id="路径" tabindex="-1">路径 <a class="header-anchor" href="#路径" aria-label="Permalink to &quot;路径&quot;">​</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">beginPath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">closePath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"></span></code></pre></div><p>如果要绘制多个图形，需要声明开始和结束路径，否则图形会相互干扰，影响结果。</p><ul><li>使用<code>fill()</code>时，路径自动闭合，可以不用<code>closePath()</code>。</li><li>使用<code>stroke()</code>时，不会闭合路径，如果没有<code>closePath()</code>，则只绘制了两条线段，不是完整的三角形</li></ul><h2 id="矩形" tabindex="-1">矩形 <a class="header-anchor" href="#矩形" aria-label="Permalink to &quot;矩形&quot;">​</a></h2><ul><li><code>fillRect(x, y, width, height)</code> 绘制填充的矩形</li><li><code>strokeRect(x, y, width, height)</code> 绘制矩形的边框</li><li><code>clearRect(x, y, width, height)</code> 清除指定矩形区域</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">beginPath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.fillStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#eee</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">fillRect</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">50</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">400</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">200</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">100</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">clearRect</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">60</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">420</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">180</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">60</span><span style="color:#F8F8F2;">) </span><span style="color:#6272A4;">// 在内部擦除一个矩形</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.strokeStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#666</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">strokeRect</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">140</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">430</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">30</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">30</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">closePath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"></span></code></pre></div><p><code>ctx.fillRect(50,400,200,100)</code>表示矩形左上角坐标为(50,400)，宽 200px，高 100px</p><h2 id="圆" tabindex="-1">圆 <a class="header-anchor" href="#圆" aria-label="Permalink to &quot;圆&quot;">​</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#50FA7B;">arc</span><span style="color:#F8F8F2;">(x, y, radius, startAngle, endAngle, anticlockwise)</span></span>
<span class="line"></span></code></pre></div><p>参数分别表示圆心坐标，半径，起始弧度，结束弧度，绘制方向</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">arc</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">100</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">100</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">50</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#BD93F9;">PI</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">false</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.fillStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#f00</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">fill</span><span style="color:#F8F8F2;">() </span><span style="color:#6272A4;">// 填充</span></span>
<span class="line"></span></code></pre></div><p>角度与弧度的 js 表达式:</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">弧度 </span><span style="color:#F1FA8C;">=</span><span style="color:#F8F8F2;"> (Math.PI/180) </span><span style="color:#BD93F9;font-style:italic;">*</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">角度</span></span>
<span class="line"></span></code></pre></div><p><code>anticlockwise</code> 为 true，则按逆时针绘制，false 按顺时针绘制，默认为 false</p><p>数学中的角度逆时针为正，而这里的起止角是以顺时针为正。当起角设为 0 度，止角设为 120 度时，会从右边水平位置向下旋转 120 度。</p><h2 id="文字" tabindex="-1">文字 <a class="header-anchor" href="#文字" aria-label="Permalink to &quot;文字&quot;">​</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">beginPath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.font </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">100px 微软雅黑</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;"> </span><span style="color:#6272A4;">// 字体大小和类型</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.strokeStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">gold</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">strokeText</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">hello world !</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">800</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">200</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.fillStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#00f</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">fillText</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">canvas</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">800</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">400</span><span style="color:#F8F8F2;">) </span><span style="color:#6272A4;">// 文字和位置</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">closePath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"></span></code></pre></div><h2 id="阴影" tabindex="-1">阴影 <a class="header-anchor" href="#阴影" aria-label="Permalink to &quot;阴影&quot;">​</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">beginPath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.fillStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#000</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.shadowOffsetX </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">10</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.shadowOffsetY </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">10</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.shadowColor </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">gold</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.shadowBlur </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">5</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">fillRect</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">600</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">400</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">200</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">200</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">closePath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"></span></code></pre></div><p><code>shadowOffsetX</code>、<code>shadowOffsetY</code>表示阴影横、纵向偏移量，<code>shadowColor</code>表示阴影颜色，<code>shadowBlur</code>表示模糊等级。</p><h2 id="渐变" tabindex="-1">渐变 <a class="header-anchor" href="#渐变" aria-label="Permalink to &quot;渐变&quot;">​</a></h2><h3 id="线性渐变" tabindex="-1">线性渐变 <a class="header-anchor" href="#线性渐变" aria-label="Permalink to &quot;线性渐变&quot;">​</a></h3><p><code>createLinearGradient(x1,y1,x2,y2)</code>，参数表示起点和终点</p><p><code>addColorStop(x,y)</code>，x 表示偏移量(0~1)，y 表示颜色</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">beginPath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> color </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> ctx.</span><span style="color:#50FA7B;">createLinearGradient</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">400</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">color.</span><span style="color:#50FA7B;">addColorStop</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">0.3</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#E55D87</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">color.</span><span style="color:#50FA7B;">addColorStop</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">0.5</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#ff0</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">color.</span><span style="color:#50FA7B;">addColorStop</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#5FC3E4</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.fillStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> color</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">fillRect</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">500</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">100</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">300</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">300</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">closePath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"></span></code></pre></div><h3 id="径向渐变" tabindex="-1">径向渐变 <a class="header-anchor" href="#径向渐变" aria-label="Permalink to &quot;径向渐变&quot;">​</a></h3><p><code>createRadialGradient(x1,y1,r1,x2,y2,r2)</code>，起始圆心、结束圆心和相关半径</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">beginPath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">arc</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">500</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">300</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">100</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">2</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#BD93F9;">PI</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">true</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> color </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> ctx.</span><span style="color:#50FA7B;">createRadialGradient</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">500</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">300</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">30</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">500</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">300</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">100</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">color.</span><span style="color:#50FA7B;">addColorStop</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">red</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">color.</span><span style="color:#50FA7B;">addColorStop</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">0.5</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">orange</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">color.</span><span style="color:#50FA7B;">addColorStop</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">, </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">yellow</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.fillStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> color</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">fill</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">ctx.</span><span style="color:#50FA7B;">closePath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"></span></code></pre></div><h2 id="图片绘制" tabindex="-1">图片绘制 <a class="header-anchor" href="#图片绘制" aria-label="Permalink to &quot;图片绘制&quot;">​</a></h2><p><code>drawImage(image, x, y)</code></p><p>其中 image 是 image 或者 canvas 对象，x 和 y 是其在目标 canvas 里的起始坐标。</p><p><code>drawImage(image, x, y, width, height)</code></p><p>width 和 height，这两个参数用来控制 当向 canvas 画入时应该缩放的大小</p><p><code>drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight)</code></p><p>image 是 image 或者 canvas 对象，前 4 个是定义图像源的切片位置和大小，后 4 个则是定义切片的目标显示位置和大小</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">draw</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> ctx </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> document.</span><span style="color:#50FA7B;">getElementById</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">first-canvas</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">).</span><span style="color:#50FA7B;">getContext</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">2d</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> img </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;font-weight:bold;">new</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">Image</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">  img.</span><span style="color:#50FA7B;">onload</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">function</span><span style="color:#F8F8F2;"> () {</span></span>
<span class="line"><span style="color:#F8F8F2;">    ctx.</span><span style="color:#50FA7B;">beginPath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">    ctx.</span><span style="color:#50FA7B;">drawImage</span><span style="color:#F8F8F2;">(img, </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    ctx.</span><span style="color:#50FA7B;">closePath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">  img.src </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">./assets/images/green1.png</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"><span style="color:#50FA7B;">draw</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"></span></code></pre></div><h2 id="移动" tabindex="-1">移动 <a class="header-anchor" href="#移动" aria-label="Permalink to &quot;移动&quot;">​</a></h2><h2 id="旋转" tabindex="-1">旋转 <a class="header-anchor" href="#旋转" aria-label="Permalink to &quot;旋转&quot;">​</a></h2><h2 id="缩放" tabindex="-1">缩放 <a class="header-anchor" href="#缩放" aria-label="Permalink to &quot;缩放&quot;">​</a></h2><h2 id="变形" tabindex="-1">变形 <a class="header-anchor" href="#变形" aria-label="Permalink to &quot;变形&quot;">​</a></h2><h2 id="裁剪" tabindex="-1">裁剪 <a class="header-anchor" href="#裁剪" aria-label="Permalink to &quot;裁剪&quot;">​</a></h2><h2 id="动画" tabindex="-1">动画 <a class="header-anchor" href="#动画" aria-label="Permalink to &quot;动画&quot;">​</a></h2><p>可以用 <code>window.setInterval()</code>, <code>window.setTimeout()</code>,和 <code>window.requestAnimationFrame()</code>来设定定期执行一个指定函数。</p><h3 id="示例-行走的绿巨人" tabindex="-1">示例：行走的绿巨人 <a class="header-anchor" href="#示例-行走的绿巨人" aria-label="Permalink to &quot;示例：行走的绿巨人&quot;">​</a></h3><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">canvas</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">id</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">first-canvas</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">width</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">2000</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">height</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">800</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">&gt;&lt;/</span><span style="color:#FF79C6;">canvas</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">div</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">style</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">display: none;</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">  &lt;</span><span style="color:#FF79C6;">img</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">src</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">./assets/images/green1.png</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">id</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">img1</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">alt</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;&quot;</span><span style="color:#F8F8F2;"> /&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;/</span><span style="color:#FF79C6;">div</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> firCanvas </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> document.</span><span style="color:#50FA7B;">getElementById</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">first-canvas</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> ctx </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> firCanvas.</span><span style="color:#50FA7B;">getContext</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">2d</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> img1 </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> document.</span><span style="color:#50FA7B;">getElementById</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">img1</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> X </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span></span>
<span class="line"><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> countNum </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">picRun</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">  ctx.</span><span style="color:#50FA7B;">clearRect</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">1200</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">1000</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">  countNum</span><span style="color:#FF79C6;">++</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> (countNum </span><span style="color:#FF79C6;">==</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">10</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">    X </span><span style="color:#FF79C6;">+=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">129</span></span>
<span class="line"><span style="color:#F8F8F2;">    countNum </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> (X </span><span style="color:#FF79C6;">&gt;=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">387</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">    X </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">  ctx.</span><span style="color:#50FA7B;">beginPath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">  ctx.</span><span style="color:#50FA7B;">drawImage</span><span style="color:#F8F8F2;">(img1, X, </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">129</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">135</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">100</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">100</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">129</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">135</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">  ctx.</span><span style="color:#50FA7B;">closePath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">  ctx.</span><span style="color:#50FA7B;">stroke</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"><span style="color:#F8F8F2;">window.</span><span style="color:#50FA7B;">setInterval</span><span style="color:#F8F8F2;">(picRun, </span><span style="color:#BD93F9;">30</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"></span></code></pre></div><p><img src="https://zghimg.oss-cn-beijing.aliyuncs.com/blog/1666417775.png" alt="image"><img src="https://zghimg.oss-cn-beijing.aliyuncs.com/blog/1666417881.png" alt="image"></p><p>类似于精灵图切割图片，图片宽 515px，高 135px，每一个小图是四分之一即 129px，高度不用切。</p><p>clearRect()清除以前的图层，防止堆积覆盖</p><p>countNum 是计数器，控制图片的切换频率</p><p>300ms，当切割宽度到达 3 个巨人宽度时归零，重新切割。</p><h2 id="图片矩形标注" tabindex="-1">图片矩形标注 <a class="header-anchor" href="#图片矩形标注" aria-label="Permalink to &quot;图片矩形标注&quot;">​</a></h2><h3 id="场景" tabindex="-1">场景 <a class="header-anchor" href="#场景" aria-label="Permalink to &quot;场景&quot;">​</a></h3><p>要在一张图片上可以画矩形标注，并将坐标传给后端，那么可以使用<code>canvas</code>，宽高和图片的宽高一样，完全覆盖在图片上。提交时的数据格式为<code>[{left:1, top:2, width:3, height:4}]</code></p><p>思路：只要获取鼠标点击的起始点和抬起的结束点，绘制矩形，然后把 canvas 坐标和图片的实际坐标转换一下就可以了</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">template</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">  &lt;</span><span style="color:#FF79C6;">div</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">style</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">position: relative</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">img</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">id</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">myimg</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">:style</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">{ width: \`\${canvasWidth}px\`, height: \`\${canvasHeight}px\` }</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">src</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">img.png</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">alt</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;&quot;</span><span style="color:#F8F8F2;"> /&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">canvas</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">id</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">cvs</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">style</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">position: absolute; top: 0; left: 0; z-index: 1</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">&gt;当前浏览器不支持Canvas&lt;/</span><span style="color:#FF79C6;">canvas</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    &lt;</span><span style="color:#FF79C6;">el-button</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">type</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">primary</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;font-style:italic;">@click</span><span style="color:#FF79C6;">=</span><span style="color:#E9F284;">&quot;</span><span style="color:#F1FA8C;">resetLine</span><span style="color:#E9F284;">&quot;</span><span style="color:#F8F8F2;">&gt;重置画线&lt;/</span><span style="color:#FF79C6;">el-button</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">  &lt;/</span><span style="color:#FF79C6;">div</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;/</span><span style="color:#FF79C6;">template</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">script</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#FF79C6;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">default</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#50FA7B;">data</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">      canvasWidth</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">900</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      canvasHeight</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">500</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      ctx</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">null</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">      historyLine</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> [],</span></span>
<span class="line"><span style="color:#F8F8F2;">      startPoint</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> [],</span></span>
<span class="line"><span style="color:#F8F8F2;">      lineList</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> [] </span><span style="color:#6272A4;">// 要提交的点坐标</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;/</span><span style="color:#FF79C6;">script</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>canvas 默认大小是宽度<code>300px</code>，高度<code>150px</code>。不能设置百分比，不能通过 css 设置宽高。可以直接设置<code>width</code>和<code>height</code>属性。如果想动态设置宽高，比如想让 canvas 的宽度占据屏幕的 70%，根据<code>16:9</code>的比例计算高度，可以使用 js 设置</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.canvasWidth </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> window.innerWidth </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">0.7</span></span>
<span class="line"><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.canvasHeight </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> (canvasWidth </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">9</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">/</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">16</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> canvas </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> document.</span><span style="color:#50FA7B;">getElementById</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">cvs</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">canvas.width </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.canvasWidth</span></span>
<span class="line"><span style="color:#F8F8F2;">canvas.height </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.canvasHeight</span></span>
<span class="line"></span></code></pre></div><h3 id="坐标转换" tabindex="-1">坐标转换 <a class="header-anchor" href="#坐标转换" aria-label="Permalink to &quot;坐标转换&quot;">​</a></h3><p>1、将屏幕坐标转化为 canvas 坐标</p><p>触发鼠标事件时，要将屏幕坐标转化为 canvas 坐标。即鼠标点击时，相对屏幕的位置要转换为相对 canvas 的位置</p><p>这段代码<code>{ x: e.offsetX, y: e.offsetY, which: e.which }</code>也可用下面的方法代替</p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect" target="_blank" rel="noreferrer">getBoundingClientRect()</a>提供了元素的大小及其相对于视口的位置</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#50FA7B;">windowToCanvas</span><span style="color:#F8F8F2;">(e, canvas) {</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> bbox </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> canvas.</span><span style="color:#50FA7B;">getBoundingClientRect</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">        x</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> e.clientX </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> bbox.left </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> (canvas.width </span><span style="color:#FF79C6;">/</span><span style="color:#F8F8F2;"> bbox.width),</span></span>
<span class="line"><span style="color:#F8F8F2;">        y</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> e.clientY </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> bbox.top </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> (canvas.height </span><span style="color:#FF79C6;">/</span><span style="color:#F8F8F2;"> bbox.height),</span></span>
<span class="line"><span style="color:#F8F8F2;">        which</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> e.which </span><span style="color:#6272A4;">// 左击 1  右击 3</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><p>2、将 canvas 坐标转为图片坐标</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">function</span><span style="color:#F8F8F2;"> </span><span style="color:#50FA7B;">transform</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">point</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> x </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> point[</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">/</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.canvasWidth </span><span style="color:#6272A4;">// 计算比例</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> y </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> point[</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">/</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.canvasHeight</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> elementImage </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> document.</span><span style="color:#50FA7B;">querySelector</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#myimg</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> originX </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#50FA7B;">round</span><span style="color:#F8F8F2;">(elementImage.naturalWidth </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> x)</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> originY </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#50FA7B;">round</span><span style="color:#F8F8F2;">(elementImage.naturalHeight </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> y)</span></span>
<span class="line"><span style="color:#F8F8F2;">  </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> [originX, originY]</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><p><code>naturalWidth</code>和<code>naturalHeight</code>是 h5 新增的属性，可以直接获取图片的原始宽高</p><h3 id="关键代码" tabindex="-1">关键代码 <a class="header-anchor" href="#关键代码" aria-label="Permalink to &quot;关键代码&quot;">​</a></h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/getImageData" target="_blank" rel="noreferrer">getImageData</a>返回一个<code>ImageData</code>对象， 用来描述 canvas 区域隐含的像素数据</p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/putImageData" target="_blank" rel="noreferrer">putImageData</a>将数据从已有的<code>ImageData</code>对象绘制到位图</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">&lt;</span><span style="color:#FF79C6;">script</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"><span style="color:#FF79C6;">export</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">default</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">  methods</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#50FA7B;">drawLine</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> canvas </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> document.</span><span style="color:#50FA7B;">getElementById</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">cvs</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">      canvas.width </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.canvasWidth</span></span>
<span class="line"><span style="color:#F8F8F2;">      canvas.height </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.canvasHeight</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> ctx </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> canvas.</span><span style="color:#50FA7B;">getContext</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">2d</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">      ctx.strokeStyle </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#f00</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.ctx </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> ctx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> dragging </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">false</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">let</span><span style="color:#F8F8F2;"> startPoint </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">      canvas.</span><span style="color:#50FA7B;">onmousedown</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> (</span><span style="color:#FFB86C;font-style:italic;">e</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">        e.</span><span style="color:#50FA7B;">preventDefault</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">        startPoint </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> { x</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> e.offsetX, y</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> e.offsetY, which</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> e.which }</span></span>
<span class="line"><span style="color:#F8F8F2;">        dragging </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">true</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.startPoint </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.</span><span style="color:#50FA7B;">transform</span><span style="color:#F8F8F2;">([startPoint.x, startPoint.y])</span></span>
<span class="line"><span style="color:#F8F8F2;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">      canvas.</span><span style="color:#50FA7B;">onmousemove</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> (</span><span style="color:#FFB86C;font-style:italic;">e</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">        e.</span><span style="color:#50FA7B;">preventDefault</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> (dragging) {</span></span>
<span class="line"><span style="color:#F8F8F2;">          </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.</span><span style="color:#50FA7B;">showLastHistory</span><span style="color:#F8F8F2;">() </span><span style="color:#6272A4;">// 每次绘制先清除上一次</span></span>
<span class="line"><span style="color:#F8F8F2;">          </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.</span><span style="color:#50FA7B;">updateRect</span><span style="color:#F8F8F2;">({ x</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> e.offsetX, y</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> e.offsetY, which</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> e.which }, startPoint)</span></span>
<span class="line"><span style="color:#F8F8F2;">        }</span></span>
<span class="line"><span style="color:#F8F8F2;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.</span><span style="color:#50FA7B;">addHistoy</span><span style="color:#F8F8F2;">(canvas.width, canvas.height) </span><span style="color:#6272A4;">// 添加一个默认的数据</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">      canvas.</span><span style="color:#50FA7B;">onmouseup</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> (</span><span style="color:#FFB86C;font-style:italic;">e</span><span style="color:#F8F8F2;">) </span><span style="color:#FF79C6;">=&gt;</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">        e.</span><span style="color:#50FA7B;">preventDefault</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">        dragging </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">false</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.</span><span style="color:#50FA7B;">addHistoy</span><span style="color:#F8F8F2;">(canvas.width, canvas.height) </span><span style="color:#6272A4;">// 保存上一次数据</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> endP </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> { x</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> e.offsetX, y</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> e.offsetY, which</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> e.which }</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> endPoint </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.</span><span style="color:#50FA7B;">transform</span><span style="color:#F8F8F2;">([endP.x, endP.y])</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> obj </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">          left</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.startPoint[</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">],</span></span>
<span class="line"><span style="color:#F8F8F2;">          top</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.startPoint[</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">],</span></span>
<span class="line"><span style="color:#F8F8F2;">          width</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#50FA7B;">abs</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.startPoint[</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> endPoint[</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">]),</span></span>
<span class="line"><span style="color:#F8F8F2;">          height</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#50FA7B;">abs</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.startPoint[</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> endPoint[</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">])</span></span>
<span class="line"><span style="color:#F8F8F2;">        }</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.lineList.</span><span style="color:#50FA7B;">push</span><span style="color:#F8F8F2;">(obj)</span></span>
<span class="line"><span style="color:#F8F8F2;">      }</span></span>
<span class="line"><span style="color:#F8F8F2;">    },</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">// 将canvas坐标转为图片坐标</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#50FA7B;">transform</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">point</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> x </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> point[</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">/</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.canvasWidth</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> y </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> point[</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">] </span><span style="color:#FF79C6;">/</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.canvasHeight</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> elementImage </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> document.</span><span style="color:#50FA7B;">querySelector</span><span style="color:#F8F8F2;">(</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">#myimg</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> originX </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#50FA7B;">round</span><span style="color:#F8F8F2;">(elementImage.naturalWidth </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> x)</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> originY </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#50FA7B;">round</span><span style="color:#F8F8F2;">(elementImage.naturalHeight </span><span style="color:#FF79C6;">*</span><span style="color:#F8F8F2;"> y)</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">return</span><span style="color:#F8F8F2;"> [originX, originY]</span></span>
<span class="line"><span style="color:#F8F8F2;">    },</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">// 重置画线</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#50FA7B;">resetLine</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">if</span><span style="color:#F8F8F2;"> (</span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.historyLine.length </span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.historyLine.</span><span style="color:#50FA7B;">pop</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.</span><span style="color:#50FA7B;">showLastHistory</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.lineList.</span><span style="color:#50FA7B;">pop</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">      }</span></span>
<span class="line"><span style="color:#F8F8F2;">    },</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#50FA7B;">addHistoy</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">width</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">height</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.historyLine.</span><span style="color:#50FA7B;">push</span><span style="color:#F8F8F2;">({ data</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.ctx.</span><span style="color:#50FA7B;">getImageData</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, width, height) })</span></span>
<span class="line"><span style="color:#F8F8F2;">    },</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#50FA7B;">showLastHistory</span><span style="color:#F8F8F2;">() {</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.ctx.</span><span style="color:#50FA7B;">putImageData</span><span style="color:#F8F8F2;">(</span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.historyLine[</span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.historyLine.length </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">][</span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">data</span><span style="color:#E9F284;">&#39;</span><span style="color:#F8F8F2;">], </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">, </span><span style="color:#BD93F9;">0</span><span style="color:#F8F8F2;">)</span></span>
<span class="line"><span style="color:#F8F8F2;">    },</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#6272A4;">// 更新矩形</span></span>
<span class="line"><span style="color:#F8F8F2;">    </span><span style="color:#50FA7B;">updateRect</span><span style="color:#F8F8F2;">(</span><span style="color:#FFB86C;font-style:italic;">point</span><span style="color:#F8F8F2;">, </span><span style="color:#FFB86C;font-style:italic;">startPoint</span><span style="color:#F8F8F2;">) {</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> w </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#50FA7B;">abs</span><span style="color:#F8F8F2;">(point.x </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> startPoint.x)</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> h </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> Math.</span><span style="color:#50FA7B;">abs</span><span style="color:#F8F8F2;">(point.y </span><span style="color:#FF79C6;">-</span><span style="color:#F8F8F2;"> startPoint.y)</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> left </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> point.x </span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;"> startPoint.x </span><span style="color:#FF79C6;">?</span><span style="color:#F8F8F2;"> startPoint.x </span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> point.x</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> top </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> point.y </span><span style="color:#FF79C6;">&gt;</span><span style="color:#F8F8F2;"> startPoint.y </span><span style="color:#FF79C6;">?</span><span style="color:#F8F8F2;"> startPoint.y </span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> point.y</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.ctx.</span><span style="color:#50FA7B;">save</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.ctx.</span><span style="color:#50FA7B;">beginPath</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.ctx.</span><span style="color:#50FA7B;">rect</span><span style="color:#F8F8F2;">(left, top, w, h)</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.ctx.</span><span style="color:#50FA7B;">stroke</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">      </span><span style="color:#BD93F9;font-style:italic;">this</span><span style="color:#F8F8F2;">.ctx.</span><span style="color:#50FA7B;">restore</span><span style="color:#F8F8F2;">()</span></span>
<span class="line"><span style="color:#F8F8F2;">    }</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"><span style="color:#F8F8F2;">&lt;/</span><span style="color:#FF79C6;">script</span><span style="color:#F8F8F2;">&gt;</span></span>
<span class="line"></span></code></pre></div>`,108),F=[o];function e(t,c,r,y,i,d){return n(),a("div",null,F)}const h=s(p,[["render",e]]);export{B as __pageData,h as default};
