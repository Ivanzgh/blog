import{_ as s,c as a,o as n,Q as l}from"./chunks/framework.f14b72c3.js";const u=JSON.parse('{"title":"MongoDB","description":"","frontmatter":{},"headers":[],"relativePath":"fe/node/mongodb.md","lastUpdated":1683514170000}'),o={name:"fe/node/mongodb.md"},p=l(`<h1 id="mongodb" tabindex="-1">MongoDB <a class="header-anchor" href="#mongodb" aria-label="Permalink to &quot;MongoDB&quot;">​</a></h1><p>官网文档：<a href="https://docs.mongodb.com" target="_blank" rel="noreferrer">https://docs.mongodb.com</a></p><p>中文文档：<a href="http://www.mongodb.org.cn/" target="_blank" rel="noreferrer">http://www.mongodb.org.cn/</a></p><p>mongoose 文档：<a href="https://mongoosejs.com/docs/index.html" target="_blank" rel="noreferrer">https://mongoosejs.com/docs/index.html</a></p><h2 id="简介" tabindex="-1">简介 <a class="header-anchor" href="#简介" aria-label="Permalink to &quot;简介&quot;">​</a></h2><p>MongoDB 是一个基于分布式文件存储的数据库。由 C++语言编写。旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。</p><p>MongoDB 是一个介于关系数据库和非关系数据库(nosql)之间的产品，是非关系数据库当中功能最丰富，最像关系数据库的。</p><h2 id="原子操作" tabindex="-1">原子操作 <a class="header-anchor" href="#原子操作" aria-label="Permalink to &quot;原子操作&quot;">​</a></h2><h3 id="set" tabindex="-1">$set <a class="header-anchor" href="#set" aria-label="Permalink to &quot;\\$set&quot;">​</a></h3><p>用来指定一个键并更新键值，若键不存在则创建。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> { title, content, contentText, category } </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> req.body</span></span>
<span class="line"><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> data </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">await</span><span style="color:#F8F8F2;"> article.</span><span style="color:#50FA7B;">findById</span><span style="color:#F8F8F2;">(id)</span></span>
<span class="line"><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> updateData </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">await</span><span style="color:#F8F8F2;"> data.</span><span style="color:#50FA7B;">update</span><span style="color:#F8F8F2;">({</span></span>
<span class="line"><span style="color:#F8F8F2;">  $set</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> {</span></span>
<span class="line"><span style="color:#F8F8F2;">    title,</span></span>
<span class="line"><span style="color:#F8F8F2;">    content,</span></span>
<span class="line"><span style="color:#F8F8F2;">    contentText,</span></span>
<span class="line"><span style="color:#F8F8F2;">    category</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">})</span></span>
<span class="line"></span></code></pre></div><h3 id="inc" tabindex="-1">$inc <a class="header-anchor" href="#inc" aria-label="Permalink to &quot;\\$inc&quot;">​</a></h3><p>对文档的某个值为数字型（只能为满足要求的数字）的键进行增减。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#FF79C6;">const</span><span style="color:#F8F8F2;"> data </span><span style="color:#FF79C6;">=</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">await</span><span style="color:#F8F8F2;"> article.</span><span style="color:#50FA7B;">findOneAndUpdate</span><span style="color:#F8F8F2;">({_id</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> id},</span></span>
<span class="line"><span style="color:#F8F8F2;">    {</span></span>
<span class="line"><span style="color:#F8F8F2;">        $inc</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> {looknums</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">}</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">&lt;!--</span><span style="color:#F8F8F2;">阅读量每次增加1</span><span style="color:#FF79C6;">--&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">        </span><span style="color:#FF79C6;">&lt;!--</span><span style="color:#F8F8F2;">若需要减少1，可写成 $inc: {looknums</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#FF79C6;">-</span><span style="color:#BD93F9;">1</span><span style="color:#F8F8F2;">}</span><span style="color:#FF79C6;">--&gt;</span></span>
<span class="line"><span style="color:#F8F8F2;">    })</span></span>
<span class="line"><span style="color:#F8F8F2;">res.</span><span style="color:#50FA7B;">json</span><span style="color:#F8F8F2;">({</span></span>
<span class="line"><span style="color:#F8F8F2;">    code</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#BD93F9;">200</span><span style="color:#F8F8F2;">,</span></span>
<span class="line"><span style="color:#F8F8F2;">    data</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> data,</span></span>
<span class="line"><span style="color:#F8F8F2;">    msg</span><span style="color:#FF79C6;">:</span><span style="color:#F8F8F2;"> </span><span style="color:#E9F284;">&#39;</span><span style="color:#F1FA8C;">阅读量修改成功</span><span style="color:#E9F284;">&#39;</span></span>
<span class="line"><span style="color:#F8F8F2;">})</span></span>
<span class="line"></span></code></pre></div><h3 id="unset" tabindex="-1">$unset <a class="header-anchor" href="#unset" aria-label="Permalink to &quot;\\$unset&quot;">​</a></h3><p>用来删除一个键。</p><h3 id="push" tabindex="-1">$push <a class="header-anchor" href="#push" aria-label="Permalink to &quot;\\$push&quot;">​</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;">{</span></span>
<span class="line"><span style="color:#F8F8F2;">  $push: {</span></span>
<span class="line"><span style="color:#F8F8F2;">    field: value</span></span>
<span class="line"><span style="color:#F8F8F2;">  }</span></span>
<span class="line"><span style="color:#F8F8F2;">}</span></span>
<span class="line"></span></code></pre></div><p>把 value 追加到 field 里面去，field 一定要是数组类型才行，如果 field 不存在，会新增一个数组类型加进去。</p><h3 id="pushall" tabindex="-1">$pushAll <a class="header-anchor" href="#pushall" aria-label="Permalink to &quot;\\$pushAll&quot;">​</a></h3><p>同$push,只是一次可以追加多个值到一个数组字段内。</p><h3 id="pull" tabindex="-1">$pull <a class="header-anchor" href="#pull" aria-label="Permalink to &quot;\\$pull&quot;">​</a></h3><p>从数组 field 内删除一个等于 value 值。</p><h3 id="addtoset" tabindex="-1">$addToSet <a class="header-anchor" href="#addtoset" aria-label="Permalink to &quot;\\$addToSet&quot;">​</a></h3><p>增加一个值到数组内，而且只有当这个值不在数组内才增加。</p><h3 id="pop" tabindex="-1">$pop <a class="header-anchor" href="#pop" aria-label="Permalink to &quot;\\$pop&quot;">​</a></h3><p>删除数组的第一个或最后一个元素</p><h3 id="rename" tabindex="-1">$rename <a class="header-anchor" href="#rename" aria-label="Permalink to &quot;\\$rename&quot;">​</a></h3><p>修改字段名称</p><h2 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-label="Permalink to &quot;常见问题&quot;">​</a></h2><h3 id="端口占用" tabindex="-1">端口占用 <a class="header-anchor" href="#端口占用" aria-label="Permalink to &quot;端口占用&quot;">​</a></h3><p>报错信息：</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki dracula"><code><span class="line"><span style="color:#F8F8F2;"> Unclean </span><span style="color:#F1FA8C;">full-time</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">diagnostic</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">data</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">capture</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">shutdown</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">detected,</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">found</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">interim</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">file,</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">some</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">metrics</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">may</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">have</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">been</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">lost.</span><span style="color:#F8F8F2;"> </span><span style="color:#F1FA8C;">OK</span></span>
<span class="line"></span></code></pre></div><p>解决方法：找到项目存放 data 的地方，删除<code>diagnostic.data</code>文件夹即可</p>`,34),e=[p];function t(F,c,r,i,d,y){return n(),a("div",null,e)}const m=s(o,[["render",t]]);export{u as __pageData,m as default};
